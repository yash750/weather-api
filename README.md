# Weather API

## Overview
This project provides a small RESTful API built with Node.js and Express to retrieve current weather information from the OpenWeather service.
It includes caching via Redis to reduce latency and repeated API calls. The API exposes a single endpoint that accepts a city name and returns formatted weather data.

## Problem Statement
Applications that need current weather data often call public weather APIs directly. This results in redundant API requests and slower responses when serving multiple clients. A lightweight service that centralizes weather lookup and caches recent results helps reduce costs and improve response times.

## Goals
- Expose a simple HTTP interface for retrieving weather data by city.
- Format the raw OpenWeather response to remove unnecessary fields and convert units to degrees Celsius.
- Cache weather data in Redis for one hour to avoid repeated external calls for the same city.

## Non‑Goals
- Support for complex search queries or historical weather information.
- User authentication or rate limiting.
- Serving a public web interface.

## API Endpoints
### `GET /`
Returns a welcome string confirming that the API is running.

### `POST /getWeather`
Retrieve current weather by city name.

**Body Parameters**
- `city` (string, required): Name of the city to fetch weather data for.

**Responses**
- `200 OK` – JSON containing formatted weather details (see below).
- `400 Bad Request` – Missing `city` parameter.
- `500 Internal Server Error` – Upstream errors or Redis failures.

When a request is made, the service first checks Redis using the key `weather?city=<city>` (see `utils/redis.js`). If present, the cached result is returned immediately. Otherwise, the server queries OpenWeather using the API key and stores the formatted result in Redis before responding.

## Result Format
The response body contains a simplified object generated by `utils/formatResult.js` with the following structure:

```json
{
  "name": "City",
  "main": {
    "temp": "Temperature in °C",
    "temp_min": "Minimum temperature in °C",
    "temp_max": "Maximum temperature in °C",
    "feels_like": "Feels‑like temperature in °C",
    "pressure": "Atmospheric pressure in kPa",
    "humidity": "Humidity percentage"
  },
  "wind": { "speed": "Wind speed" },
  "clouds": { "all": "Cloud coverage" },
  "timezone": "Offset from UTC in hours",
  "dt": "Local date/time of the data"
}
```

## Environment Variables
Create a `.env` file (excluded from version control) with the following variables:

```
WEATHER_API_KEY=<Your OpenWeather API key>
PORT=3000 # optional, defaults to 3000
```

The application loads these using `dotenv` (`server.js` lines 8‑11).

## Setup
1. Install Node.js 18 or later.
2. Run `npm install` to install dependencies.
3. Configure a local Redis instance running on default port `6379`.
4. Create a `.env` file with your OpenWeather API key.
5. Start the development server with `npm start`.

## Example Request
Using `curl`:

```bash
curl -X POST http://localhost:3000/getWeather \
  -H "Content-Type: application/json" \
  -d '{"city": "London"}'
```

The first request will fetch data from OpenWeather and cache it. Subsequent requests for the same city within an hour will return the cached response.

## Project Structure
```
server.js           # Express server with routing
utils/
  fetchWeatherDetails.js  # External API call and caching logic
  formatResult.js         # Shapes the weather response
  redis.js                # Redis helper functions
```

## Future Improvements
- Add automated tests.
- Implement request validation and improved error handling.
- Support additional endpoints (e.g., forecast, units selection).

